# yaml-language-server: $schema=https://www.authelia.com/schemas/latest/json-schema/configuration.json
server:
  address: "tcp://:9091/"
  disable_healthcheck: true
authentication_backend:
  password_reset:
    disable: true
  password_change:
    disable: true
  file:
    path: "/etc/users/users_database.yml"
    search:
      email: false
      case_insensitive: true
access_control:
  default_policy: "one_factor"
identity_validation:
  reset_password:
    jwt_secret: '{{`{{- secret "/etc/authelia-secret/jwt_secret" }}`}}'
storage:
  encryption_key: '{{`{{- secret "/etc/authelia-secret/encryption_key" }}`}}'
  postgres:
    address: '{{`tcp://{{- secret "/etc/db-secret/host" }}:{{- secret "/etc/db-secret/port" }}`}}'
    database: '{{`{{- secret "/etc/db-secret/dbname" }}`}}'
    username: '{{`{{- secret "/etc/db-secret/username" }}`}}'
    password: '{{`{{- secret "/etc/db-secret/password" }}`}}'
notifier:
  filesystem:
    filename: "/data/notification.txt"
session:
  secret: '{{`{{- secret "/etc/authelia-secret/session_secret" }}`}}'
  cookies:
    - name: "authelia_session"
      domain: "{{ .Values.vadderung.baseDomain }}"
      authelia_url: "https://auth.{{ .Values.vadderung.baseDomain }}"
      expiration: "1 week"
      inactivity: "1 day"
  redis:
    host: "authelia-dragonfly-cluster"
identity_providers:
  oidc:
    hmac_secret: '{{`{{- secret "/run/secrets/oidc/hmac_secret" }}`}}'
    jwks:
      - algorithm: "RS256"
        use: sig
        key: '{{`{{ secret "/run/secrets/oidc/jwks.key" | mindent 10 "|" | msquote }}`}}'
        # certificate_chain: '{{`{{ secret "/run/secrets/oidc-jwk/jwks/rsa.2048.key" | mindent 10 "|" | msquote }}`}}'
